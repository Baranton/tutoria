

<div class="dashboard-container">
  <h3 class="dashboard-title">Overview - <span class="dashboard-user"><%= @user.first_name%></span></h3>
  <div class="row">

    <div class="col-xs-1 col-sm-1 col-md-1 col-lg-1" >
    </div>

    <div class="col-xs-12 col-sm-5 col-md-5 col-lg-5" >
      <div class="dashboard-left">
        <div class="dashboard-tutorials dashboard-section">
          <h5>Tutorials</h5>
          <hr>
          <ul>
            <% @tutorials.each do |tutorial| %>
            <span></span><li><strong><%= tutorial.product %></strong> - <%= tutorial.title %></li>
            <%= link_to "View", company_tutorial_path(tutorial.company.id, tutorial.id), class: "btn btn-outline-primary button-size" %> <br><br>
            <% end %>
          </ul>
        </div>
      </div>
    </div>

    <div class="col-xs-12 col-sm-5 col-md-5 col-lg-5">
      <div class="dashboard-right">

        <div class="dashboard-tutorials-actions dashboard-section">
          <h5>Actions</h5>


          <%= link_to "Tutorial Studio", root_path, class: "btn btn-outline-primary button-size" %><br>

          <% if @user.status == "manager" %>
          <%= link_to "Add Team Member", new_user_invitation_path(:user), class: "btn btn-outline-success button-size" %><br>
          <% end %>
          <!--
          <div class="dashboard-action">
            <i class="fas fa-chart-line"></i> <%= link_to "Analytics" %><br>
          </div>
        -->
      </div>

      <div class="dashboard-staff dashboard-section">
          <h5>Team</h5>
          <hr>
          <ul>
            <% @staff.each do |staff| %>
            <li><%= staff.first_name %> <%= staff.last_name %> - <%= staff.status %>

              <% if @user.status == "manager" %>
              <% if staff.status == "staff" %>
              <%= link_to "Upgrade", company_make_manager_path(@company.id, staff.id), method: :patch, class: "btn btn-outline-primary button-size" %>
              <% if staff.id != @user.id && staff.status == "staff"%>
              <%= link_to "Delete", company_user_path(@company.id, staff.id), method: :delete, class: "btn btn-outline-primary button-size" %>
              <% end %>
              <% end %>
            </li>
            <% end %>
            <% end %>
          </ul>

        </div>

    </div>
  </div>

  <div class="col-xs-1 col-sm-1 col-md-1 col-lg-1" >
  </div>

</div>

<div class="row">
  <div class="col-xs-1 col-sm-1 col-md-1 col-lg-1" >
  </div>

  <div class="col-xs-10 col-sm-10 col-md-10 col-lg-10" >
    <h5>Help Desk </h5>
    <div class="dashboard-questions">
      <ol>
        <% @tutorials.each do |tutorial| %>
        <% if tutorial.questions.exists? && !tutorial.questions.pluck(:answered).all?  %>
        <% questions = tutorial.questions %>
        <% step_start_times = tutorial.steps.map {|step| step.start_time } %>
        <% questions.each do |question| %>
        <% if !question.answered %>
        <div class="card question-card" style="width: auto;">
          <div class="card-body">
            <h5 class="card-title"> Step <%= "#{step_start_times.find_index(question.step.start_time) + 1}" %></h5>
            <h6 class="card-subtitle mb-2 text-muted"><%= tutorial.title %></h6>
            <p class="card-text"><%= question.content %> </p>
            <button type="button" data-value="<%= question.id %>" data-question="<%= question.content %>" class="btn btn-primary btn-circle" data-toggle="modal" data-target="#exampleModalCenter"><i class="fas fa-reply"></i></button>
            <%= link_to question_path(question.id), method: :delete, class: "btn btn-primary btn-circle" do %>
            <i class="fas fa-trash-alt"></i>
            <% end %>
          </div>
        </div>
        <% end %>
        <% end %>
        <% end %>
        <% end %>
      </ol>
    </div>
  </div>
  <div class="col-xs-1 col-sm-1 col-md-1 col-lg-1" >
  </div>
</div>


</div>

<!-- Modal -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Answer question</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">

        <form class="simple_form new_answer" id="new_answer" novalidate="novalidate" action="/questions/:question_id/answers" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="âœ“"><input type="hidden" name="authenticity_token" value="mpAGFQzlet+3Jjw6mMY8fpLyXXhhKm0ZtDL8EiFpLMtKICrmp9JEbM1t6K9LgQgO5iVUMHva1A5+gKdvp/c0KA==">

          <p id="modal-question"></p>

          <textarea label="Your question" placeholder="Enter answer here" rows="5" cols="50" name="question[content]" id="question_content"></textarea>

          <input type="submit" name="commit" value="Submit" class="btn btn btn-primary" data-disable-with="Submit">
        </form>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
